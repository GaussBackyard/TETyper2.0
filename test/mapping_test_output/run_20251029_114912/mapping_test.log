2025-10-29 11:49:12,370 - __main__ - INFO - ================================================================================
2025-10-29 11:49:12,370 - __main__ - INFO - TETyper 2.0 Mapping Module - Comprehensive Testing
2025-10-29 11:49:12,370 - __main__ - INFO - ================================================================================
2025-10-29 11:49:12,370 - __main__ - INFO - Project root: /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0
2025-10-29 11:49:12,370 - __main__ - INFO - Test output directory: /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912
2025-10-29 11:49:12,370 - __main__ - INFO - Log file: /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/mapping_test.log
2025-10-29 11:49:12,370 - __main__ - INFO - ================================================================================
2025-10-29 11:49:12,370 - __main__ - INFO - 
[TEST 0] Setting up test directory structure...
2025-10-29 11:49:12,371 - __main__ - INFO - ✓ Created directory: test/mapping_test_output/run_20251029_114912/references
2025-10-29 11:49:12,371 - __main__ - INFO - ✓ Created directory: test/mapping_test_output/run_20251029_114912/reads
2025-10-29 11:49:12,371 - __main__ - INFO - ✓ Created directory: test/mapping_test_output/run_20251029_114912/mappings
2025-10-29 11:49:12,371 - __main__ - INFO - ✓ Created directory: test/mapping_test_output/run_20251029_114912/bam_files
2025-10-29 11:49:12,371 - __main__ - INFO - 
[TEST 1] Checking external tool availability...
2025-10-29 11:49:12,372 - __main__ - INFO - ✓ bwa is available in PATH
2025-10-29 11:49:12,394 - __main__ - INFO -   Version: Version: 0.7.19-r1273
2025-10-29 11:49:12,395 - __main__ - INFO - ✓ samtools is available in PATH
2025-10-29 11:49:12,710 - __main__ - INFO -   Version: samtools 1.22.1
2025-10-29 11:49:12,711 - __main__ - INFO - ✓ Tool availability report saved to: test/mapping_test_output/run_20251029_114912/tool_availability.txt
2025-10-29 11:49:12,711 - __main__ - INFO - 
[TEST 2] Creating test reference sequences...
2025-10-29 11:49:12,711 - __main__ - INFO - ✓ Created test IRL FASTA: test/mapping_test_output/run_20251029_114912/references/Tn2_IRL_test.fasta
2025-10-29 11:49:12,711 - __main__ - INFO -   Sequence length: 40 bp
2025-10-29 11:49:12,712 - __main__ - INFO - ✓ Created test IRR FASTA: test/mapping_test_output/run_20251029_114912/references/Tn2_IRR_test.fasta
2025-10-29 11:49:12,712 - __main__ - INFO -   Sequence length: 40 bp
2025-10-29 11:49:12,712 - __main__ - INFO - 
[TEST 3] Testing BWA index creation...
2025-10-29 11:49:12,712 - __main__ - INFO - Creating BWA index for IRL reference...
2025-10-29 11:49:12,712 - __main__ - INFO - Creating BWA index for /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/references/Tn2_IRL_test.fasta
2025-10-29 11:49:12,719 - __main__ - INFO - BWA index created successfully for /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/references/Tn2_IRL_test.fasta
2025-10-29 11:49:12,719 - __main__ - INFO - ✓ IRL index creation successful
2025-10-29 11:49:12,719 - __main__ - DEBUG -   ✓ amb file exists (7 bytes)
2025-10-29 11:49:12,719 - __main__ - DEBUG -   ✓ ann file exists (32 bytes)
2025-10-29 11:49:12,719 - __main__ - DEBUG -   ✓ bwt file exists (124 bytes)
2025-10-29 11:49:12,719 - __main__ - DEBUG -   ✓ pac file exists (12 bytes)
2025-10-29 11:49:12,719 - __main__ - DEBUG -   ✓ sa file exists (72 bytes)
2025-10-29 11:49:12,719 - __main__ - INFO - ✓ Index report saved to: test/mapping_test_output/run_20251029_114912/index_files_IRL.txt
2025-10-29 11:49:12,719 - __main__ - INFO - Testing index detection (should skip re-indexing)...
2025-10-29 11:49:12,719 - __main__ - INFO - BWA index already exists for /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/references/Tn2_IRL_test.fasta
2025-10-29 11:49:12,720 - __main__ - INFO - ✓ Correctly detected existing index
2025-10-29 11:49:12,720 - __main__ - INFO - Creating BWA index for IRR reference...
2025-10-29 11:49:12,720 - __main__ - INFO - Creating BWA index for /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/references/Tn2_IRR_test.fasta
2025-10-29 11:49:12,727 - __main__ - INFO - BWA index created successfully for /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/references/Tn2_IRR_test.fasta
2025-10-29 11:49:12,727 - __main__ - INFO - ✓ IRR index creation successful
2025-10-29 11:49:12,727 - __main__ - INFO - 
[TEST 4] Creating mock FASTQ files for alignment testing...
2025-10-29 11:49:12,727 - __main__ - INFO - ✓ Created mock R1 FASTQ: test/mapping_test_output/run_20251029_114912/reads/test_sample_R1.fastq
2025-10-29 11:49:12,727 - __main__ - INFO -   Number of reads: 3
2025-10-29 11:49:12,728 - __main__ - INFO - ✓ Created mock R2 FASTQ: test/mapping_test_output/run_20251029_114912/reads/test_sample_R2.fastq
2025-10-29 11:49:12,728 - __main__ - INFO -   Number of reads: 3
2025-10-29 11:49:12,728 - __main__ - INFO - 
[TEST 5] Testing BWA alignment...
2025-10-29 11:49:12,728 - __main__ - INFO - Running BWA MEM alignment to IRL reference...
2025-10-29 11:49:12,728 - __main__ - INFO - BWA index already exists for /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/references/Tn2_IRL_test.fasta
2025-10-29 11:49:12,728 - __main__ - INFO - Aligning reads to /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/references/Tn2_IRL_test.fasta
2025-10-29 11:49:12,728 - __main__ - DEBUG - BWA command: bwa mem -t 2 -R @RG\tID:TEST001\tSM:TEST001\tPL:ILLUMINA /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/references/Tn2_IRL_test.fasta /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/reads/test_sample_R1.fastq /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/reads/test_sample_R2.fastq
2025-10-29 11:49:12,732 - __main__ - INFO - BWA alignment completed: /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/mappings/test_sample_IRL.sam
2025-10-29 11:49:12,732 - __main__ - INFO - ✓ SAM file created: test/mapping_test_output/run_20251029_114912/mappings/test_sample_IRL.sam
2025-10-29 11:49:12,732 - __main__ - INFO -   File size: 957 bytes
2025-10-29 11:49:12,732 - __main__ - INFO -   Header lines: 4
2025-10-29 11:49:12,732 - __main__ - INFO -   Alignment records: 2
2025-10-29 11:49:12,733 - __main__ - INFO - ✓ Alignment summary saved to: test/mapping_test_output/run_20251029_114912/alignment_summary.txt
2025-10-29 11:49:12,733 - __main__ - INFO - 
[TEST 6] Testing SAMtools BAM processing...
2025-10-29 11:49:12,733 - __main__ - INFO - Converting SAM to sorted BAM...
2025-10-29 11:49:12,733 - __main__ - INFO - Converting /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/mappings/test_sample_IRL.sam to BAM format
2025-10-29 11:49:12,759 - __main__ - INFO - Sorting BAM file to /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/bam_files/test_sample_IRL_sorted.bam
2025-10-29 11:49:12,774 - __main__ - INFO - Sorted BAM file created: /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/bam_files/test_sample_IRL_sorted.bam
2025-10-29 11:49:12,774 - __main__ - INFO - ✓ BAM file created: test/mapping_test_output/run_20251029_114912/bam_files/test_sample_IRL_sorted.bam
2025-10-29 11:49:12,775 - __main__ - INFO -   File size: 576 bytes
2025-10-29 11:49:12,775 - __main__ - INFO - Creating BAM index...
2025-10-29 11:49:12,775 - __main__ - INFO - Creating BAM index for /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/bam_files/test_sample_IRL_sorted.bam
2025-10-29 11:49:12,778 - __main__ - INFO - BAM index created: /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/bam_files/test_sample_IRL_sorted.bam.bai
2025-10-29 11:49:12,779 - __main__ - INFO - ✓ BAM index created: test/mapping_test_output/run_20251029_114912/bam_files/test_sample_IRL_sorted.bam.bai
2025-10-29 11:49:12,779 - __main__ - INFO -   Index size: 96 bytes
2025-10-29 11:49:12,779 - __main__ - INFO - Testing index detection (should skip re-indexing)...
2025-10-29 11:49:12,779 - __main__ - DEBUG - BAM index already exists: /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/bam_files/test_sample_IRL_sorted.bam.bai
2025-10-29 11:49:12,779 - __main__ - INFO - ✓ Correctly detected existing index
2025-10-29 11:49:12,779 - __main__ - INFO - Retrieving alignment statistics with samtools flagstat...
2025-10-29 11:49:12,782 - __main__ - INFO - ✓ Flagstat output saved to: test/mapping_test_output/run_20251029_114912/flagstat_output.txt
2025-10-29 11:49:12,782 - __main__ - INFO - Alignment statistics:
2025-10-29 11:49:12,782 - __main__ - INFO -   2 + 0 in total (QC-passed reads + QC-failed reads)
2025-10-29 11:49:12,782 - __main__ - INFO -   2 + 0 primary
2025-10-29 11:49:12,782 - __main__ - INFO -   0 + 0 secondary
2025-10-29 11:49:12,782 - __main__ - INFO -   0 + 0 supplementary
2025-10-29 11:49:12,782 - __main__ - INFO -   0 + 0 duplicates
2025-10-29 11:49:12,782 - __main__ - INFO -   0 + 0 primary duplicates
2025-10-29 11:49:12,782 - __main__ - INFO -   2 + 0 mapped (100.00% : N/A)
2025-10-29 11:49:12,782 - __main__ - INFO -   2 + 0 primary mapped (100.00% : N/A)
2025-10-29 11:49:12,782 - __main__ - INFO -   2 + 0 paired in sequencing
2025-10-29 11:49:12,783 - __main__ - INFO -   1 + 0 read1
2025-10-29 11:49:12,783 - __main__ - INFO -   1 + 0 read2
2025-10-29 11:49:12,783 - __main__ - INFO -   0 + 0 properly paired (0.00% : N/A)
2025-10-29 11:49:12,783 - __main__ - INFO -   2 + 0 with itself and mate mapped
2025-10-29 11:49:12,783 - __main__ - INFO -   0 + 0 singletons (0.00% : N/A)
2025-10-29 11:49:12,783 - __main__ - INFO -   0 + 0 with mate mapped to a different chr
2025-10-29 11:49:12,783 - __main__ - INFO -   0 + 0 with mate mapped to a different chr (mapQ>=5)
2025-10-29 11:49:12,783 - __main__ - INFO - 
[TEST 7] Testing TEMapper high-level interface...
2025-10-29 11:49:12,783 - __main__ - INFO - Testing map_reads_to_ir for IRL...
2025-10-29 11:49:12,783 - __main__ - INFO - BWA index already exists for /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/references/Tn2_IRL_test.fasta
2025-10-29 11:49:12,783 - __main__ - INFO - Aligning reads to /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/references/Tn2_IRL_test.fasta
2025-10-29 11:49:12,783 - __main__ - DEBUG - BWA command: bwa mem -t 2 -R @RG\tID:TEST001\tSM:TEST001\tPL:ILLUMINA /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/references/Tn2_IRL_test.fasta /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/reads/test_sample_R1.fastq /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/reads/test_sample_R2.fastq
2025-10-29 11:49:12,786 - __main__ - INFO - BWA alignment completed: /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/bam_files/temapper_output/TEST001_IRL.sam
2025-10-29 11:49:12,787 - __main__ - INFO - Converting /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/bam_files/temapper_output/TEST001_IRL.sam to BAM format
2025-10-29 11:49:12,811 - __main__ - INFO - Sorting BAM file to /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/bam_files/temapper_output/TEST001_IRL_sorted.bam
2025-10-29 11:49:12,826 - __main__ - DEBUG - Removed SAM file: /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/bam_files/temapper_output/TEST001_IRL.sam
2025-10-29 11:49:12,826 - __main__ - INFO - Sorted BAM file created: /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/bam_files/temapper_output/TEST001_IRL_sorted.bam
2025-10-29 11:49:12,826 - __main__ - INFO - Creating BAM index for /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/bam_files/temapper_output/TEST001_IRL_sorted.bam
2025-10-29 11:49:12,830 - __main__ - INFO - BAM index created: /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/bam_files/temapper_output/TEST001_IRL_sorted.bam.bai
2025-10-29 11:49:12,830 - __main__ - INFO - Successfully mapped TEST001 to IRL: /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/bam_files/temapper_output/TEST001_IRL_sorted.bam
2025-10-29 11:49:12,830 - __main__ - INFO - ✓ IRL BAM created via TEMapper: test/mapping_test_output/run_20251029_114912/bam_files/temapper_output/TEST001_IRL_sorted.bam
2025-10-29 11:49:12,830 - __main__ - INFO - ✓ BAM index exists: test/mapping_test_output/run_20251029_114912/bam_files/temapper_output/TEST001_IRL_sorted.bam.bai
2025-10-29 11:49:12,830 - __main__ - INFO - Testing map_sample_to_te (IRL + IRR)...
2025-10-29 11:49:12,830 - __main__ - INFO - Mapping sample TEST001 to TE references
2025-10-29 11:49:12,830 - __main__ - INFO - BWA index already exists for /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/references/Tn2_IRL_test.fasta
2025-10-29 11:49:12,831 - __main__ - INFO - Aligning reads to /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/references/Tn2_IRL_test.fasta
2025-10-29 11:49:12,831 - __main__ - DEBUG - BWA command: bwa mem -t 2 -R @RG\tID:TEST001\tSM:TEST001\tPL:ILLUMINA /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/references/Tn2_IRL_test.fasta /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/reads/test_sample_R1.fastq /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/reads/test_sample_R2.fastq
2025-10-29 11:49:12,834 - __main__ - INFO - BWA alignment completed: /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/bam_files/full_mapping_output/TEST001_IRL.sam
2025-10-29 11:49:12,834 - __main__ - INFO - Converting /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/bam_files/full_mapping_output/TEST001_IRL.sam to BAM format
2025-10-29 11:49:12,858 - __main__ - INFO - Sorting BAM file to /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/bam_files/full_mapping_output/TEST001_IRL_sorted.bam
2025-10-29 11:49:12,874 - __main__ - DEBUG - Removed SAM file: /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/bam_files/full_mapping_output/TEST001_IRL.sam
2025-10-29 11:49:12,874 - __main__ - INFO - Sorted BAM file created: /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/bam_files/full_mapping_output/TEST001_IRL_sorted.bam
2025-10-29 11:49:12,874 - __main__ - INFO - Creating BAM index for /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/bam_files/full_mapping_output/TEST001_IRL_sorted.bam
2025-10-29 11:49:12,878 - __main__ - INFO - BAM index created: /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/bam_files/full_mapping_output/TEST001_IRL_sorted.bam.bai
2025-10-29 11:49:12,878 - __main__ - INFO - Successfully mapped TEST001 to IRL: /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/bam_files/full_mapping_output/TEST001_IRL_sorted.bam
2025-10-29 11:49:12,878 - __main__ - INFO - BWA index already exists for /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/references/Tn2_IRR_test.fasta
2025-10-29 11:49:12,878 - __main__ - INFO - Aligning reads to /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/references/Tn2_IRR_test.fasta
2025-10-29 11:49:12,878 - __main__ - DEBUG - BWA command: bwa mem -t 2 -R @RG\tID:TEST001\tSM:TEST001\tPL:ILLUMINA /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/references/Tn2_IRR_test.fasta /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/reads/test_sample_R1.fastq /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/reads/test_sample_R2.fastq
2025-10-29 11:49:12,881 - __main__ - INFO - BWA alignment completed: /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/bam_files/full_mapping_output/TEST001_IRR.sam
2025-10-29 11:49:12,882 - __main__ - INFO - Converting /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/bam_files/full_mapping_output/TEST001_IRR.sam to BAM format
2025-10-29 11:49:12,906 - __main__ - INFO - Sorting BAM file to /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/bam_files/full_mapping_output/TEST001_IRR_sorted.bam
2025-10-29 11:49:12,922 - __main__ - DEBUG - Removed SAM file: /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/bam_files/full_mapping_output/TEST001_IRR.sam
2025-10-29 11:49:12,922 - __main__ - INFO - Sorted BAM file created: /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/bam_files/full_mapping_output/TEST001_IRR_sorted.bam
2025-10-29 11:49:12,922 - __main__ - INFO - Creating BAM index for /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/bam_files/full_mapping_output/TEST001_IRR_sorted.bam
2025-10-29 11:49:12,926 - __main__ - INFO - BAM index created: /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/bam_files/full_mapping_output/TEST001_IRR_sorted.bam.bai
2025-10-29 11:49:12,926 - __main__ - INFO - Successfully mapped TEST001 to IRR: /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/bam_files/full_mapping_output/TEST001_IRR_sorted.bam
2025-10-29 11:49:12,926 - __main__ - INFO - ✓ Full TE mapping completed
2025-10-29 11:49:12,926 - __main__ - INFO -   IRL BAM: test/mapping_test_output/run_20251029_114912/bam_files/full_mapping_output/TEST001_IRL_sorted.bam (exists: True)
2025-10-29 11:49:12,926 - __main__ - INFO -   IRR BAM: test/mapping_test_output/run_20251029_114912/bam_files/full_mapping_output/TEST001_IRR_sorted.bam (exists: True)
2025-10-29 11:49:12,927 - __main__ - INFO - ✓ Mapping summary saved to: test/mapping_test_output/run_20251029_114912/temapper_summary.txt
2025-10-29 11:49:12,927 - __main__ - INFO - 
[TEST 8] Testing ParallelMapper with multiple samples...
2025-10-29 11:49:12,927 - __main__ - INFO - Mapping 2 samples in parallel...
2025-10-29 11:49:12,927 - __main__ - INFO - Starting parallel mapping of 2 samples with 2 workers
2025-10-29 11:49:12,939 - __main__ - INFO - Mapping sample TEST001 to TE references
2025-10-29 11:49:12,939 - __main__ - INFO - Mapping sample TEST002 to TE references
2025-10-29 11:49:12,940 - __main__ - INFO - BWA index already exists for /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/references/Tn2_IRL_test.fasta
2025-10-29 11:49:12,940 - __main__ - INFO - Aligning reads to /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/references/Tn2_IRL_test.fasta
2025-10-29 11:49:12,940 - __main__ - DEBUG - BWA command: bwa mem -t 1 -R @RG\tID:TEST001\tSM:TEST001\tPL:ILLUMINA /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/references/Tn2_IRL_test.fasta /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/reads/test_sample_R1.fastq /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/reads/test_sample_R2.fastq
2025-10-29 11:49:12,940 - __main__ - INFO - BWA index already exists for /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/references/Tn2_IRL_test.fasta
2025-10-29 11:49:12,940 - __main__ - INFO - Aligning reads to /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/references/Tn2_IRL_test.fasta
2025-10-29 11:49:12,940 - __main__ - DEBUG - BWA command: bwa mem -t 1 -R @RG\tID:TEST002\tSM:TEST002\tPL:ILLUMINA /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/references/Tn2_IRL_test.fasta /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/reads/test_sample_R1.fastq /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/reads/test_sample_R2.fastq
2025-10-29 11:49:12,943 - __main__ - INFO - BWA alignment completed: /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/bam_files/parallel_output/TEST001/TEST001_IRL.sam
2025-10-29 11:49:12,943 - __main__ - INFO - BWA alignment completed: /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/bam_files/parallel_output/TEST002/TEST002_IRL.sam
2025-10-29 11:49:12,944 - __main__ - INFO - Converting /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/bam_files/parallel_output/TEST001/TEST001_IRL.sam to BAM format
2025-10-29 11:49:12,944 - __main__ - INFO - Converting /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/bam_files/parallel_output/TEST002/TEST002_IRL.sam to BAM format
2025-10-29 11:49:12,968 - __main__ - INFO - Sorting BAM file to /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/bam_files/parallel_output/TEST002/TEST002_IRL_sorted.bam
2025-10-29 11:49:12,968 - __main__ - INFO - Sorting BAM file to /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/bam_files/parallel_output/TEST001/TEST001_IRL_sorted.bam
2025-10-29 11:49:12,973 - __main__ - DEBUG - Removed SAM file: /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/bam_files/parallel_output/TEST001/TEST001_IRL.sam
2025-10-29 11:49:12,973 - __main__ - INFO - Sorted BAM file created: /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/bam_files/parallel_output/TEST001/TEST001_IRL_sorted.bam
2025-10-29 11:49:12,973 - __main__ - DEBUG - Removed SAM file: /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/bam_files/parallel_output/TEST002/TEST002_IRL.sam
2025-10-29 11:49:12,973 - __main__ - INFO - Creating BAM index for /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/bam_files/parallel_output/TEST001/TEST001_IRL_sorted.bam
2025-10-29 11:49:12,973 - __main__ - INFO - Sorted BAM file created: /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/bam_files/parallel_output/TEST002/TEST002_IRL_sorted.bam
2025-10-29 11:49:12,973 - __main__ - INFO - Creating BAM index for /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/bam_files/parallel_output/TEST002/TEST002_IRL_sorted.bam
2025-10-29 11:49:12,977 - __main__ - INFO - BAM index created: /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/bam_files/parallel_output/TEST001/TEST001_IRL_sorted.bam.bai
2025-10-29 11:49:12,977 - __main__ - INFO - Successfully mapped TEST001 to IRL: /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/bam_files/parallel_output/TEST001/TEST001_IRL_sorted.bam
2025-10-29 11:49:12,977 - __main__ - INFO - BAM index created: /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/bam_files/parallel_output/TEST002/TEST002_IRL_sorted.bam.bai
2025-10-29 11:49:12,977 - __main__ - INFO - Successfully mapped TEST002 to IRL: /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/bam_files/parallel_output/TEST002/TEST002_IRL_sorted.bam
2025-10-29 11:49:12,977 - __main__ - INFO - BWA index already exists for /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/references/Tn2_IRR_test.fasta
2025-10-29 11:49:12,978 - __main__ - INFO - Aligning reads to /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/references/Tn2_IRR_test.fasta
2025-10-29 11:49:12,978 - __main__ - DEBUG - BWA command: bwa mem -t 1 -R @RG\tID:TEST001\tSM:TEST001\tPL:ILLUMINA /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/references/Tn2_IRR_test.fasta /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/reads/test_sample_R1.fastq /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/reads/test_sample_R2.fastq
2025-10-29 11:49:12,978 - __main__ - INFO - BWA index already exists for /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/references/Tn2_IRR_test.fasta
2025-10-29 11:49:12,978 - __main__ - INFO - Aligning reads to /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/references/Tn2_IRR_test.fasta
2025-10-29 11:49:12,978 - __main__ - DEBUG - BWA command: bwa mem -t 1 -R @RG\tID:TEST002\tSM:TEST002\tPL:ILLUMINA /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/references/Tn2_IRR_test.fasta /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/reads/test_sample_R1.fastq /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/reads/test_sample_R2.fastq
2025-10-29 11:49:12,981 - __main__ - INFO - BWA alignment completed: /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/bam_files/parallel_output/TEST001/TEST001_IRR.sam
2025-10-29 11:49:12,981 - __main__ - INFO - BWA alignment completed: /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/bam_files/parallel_output/TEST002/TEST002_IRR.sam
2025-10-29 11:49:12,981 - __main__ - INFO - Converting /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/bam_files/parallel_output/TEST001/TEST001_IRR.sam to BAM format
2025-10-29 11:49:12,981 - __main__ - INFO - Converting /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/bam_files/parallel_output/TEST002/TEST002_IRR.sam to BAM format
2025-10-29 11:49:13,006 - __main__ - INFO - Sorting BAM file to /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/bam_files/parallel_output/TEST001/TEST001_IRR_sorted.bam
2025-10-29 11:49:13,006 - __main__ - INFO - Sorting BAM file to /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/bam_files/parallel_output/TEST002/TEST002_IRR_sorted.bam
2025-10-29 11:49:13,011 - __main__ - DEBUG - Removed SAM file: /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/bam_files/parallel_output/TEST001/TEST001_IRR.sam
2025-10-29 11:49:13,011 - __main__ - INFO - Sorted BAM file created: /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/bam_files/parallel_output/TEST001/TEST001_IRR_sorted.bam
2025-10-29 11:49:13,011 - __main__ - DEBUG - Removed SAM file: /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/bam_files/parallel_output/TEST002/TEST002_IRR.sam
2025-10-29 11:49:13,011 - __main__ - INFO - Creating BAM index for /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/bam_files/parallel_output/TEST001/TEST001_IRR_sorted.bam
2025-10-29 11:49:13,011 - __main__ - INFO - Sorted BAM file created: /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/bam_files/parallel_output/TEST002/TEST002_IRR_sorted.bam
2025-10-29 11:49:13,011 - __main__ - INFO - Creating BAM index for /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/bam_files/parallel_output/TEST002/TEST002_IRR_sorted.bam
2025-10-29 11:49:13,015 - __main__ - INFO - BAM index created: /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/bam_files/parallel_output/TEST001/TEST001_IRR_sorted.bam.bai
2025-10-29 11:49:13,015 - __main__ - INFO - Successfully mapped TEST001 to IRR: /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/bam_files/parallel_output/TEST001/TEST001_IRR_sorted.bam
2025-10-29 11:49:13,015 - __main__ - INFO - BAM index created: /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/bam_files/parallel_output/TEST002/TEST002_IRR_sorted.bam.bai
2025-10-29 11:49:13,015 - __main__ - INFO - Successfully mapped TEST002 to IRR: /sfs/gpfs/tardis/home/jl9gx/plasmid/TETyper2.0/test/mapping_test_output/run_20251029_114912/bam_files/parallel_output/TEST002/TEST002_IRR_sorted.bam
2025-10-29 11:49:13,015 - __main__ - INFO - Completed mapping for TEST001
2025-10-29 11:49:13,015 - __main__ - INFO - Completed mapping for TEST002
2025-10-29 11:49:13,017 - __main__ - INFO - Parallel mapping completed. Success: 2, Failed: 0
2025-10-29 11:49:13,017 - __main__ - INFO - ✓ Parallel mapping completed
2025-10-29 11:49:13,017 - __main__ - INFO -   Successfully mapped: 2 samples
2025-10-29 11:49:13,017 - __main__ - INFO -   TEST001:
2025-10-29 11:49:13,018 - __main__ - INFO -     IRL BAM exists: True
2025-10-29 11:49:13,018 - __main__ - INFO -     IRR BAM exists: True
2025-10-29 11:49:13,018 - __main__ - INFO -   TEST002:
2025-10-29 11:49:13,018 - __main__ - INFO -     IRL BAM exists: True
2025-10-29 11:49:13,018 - __main__ - INFO -     IRR BAM exists: True
2025-10-29 11:49:13,018 - __main__ - INFO - ✓ Parallel mapping summary saved to: test/mapping_test_output/run_20251029_114912/parallel_mapping_summary.txt
2025-10-29 11:49:13,018 - __main__ - INFO - 
================================================================================
2025-10-29 11:49:13,018 - __main__ - INFO - GENERATING FINAL TEST SUMMARY
2025-10-29 11:49:13,018 - __main__ - INFO - ================================================================================
2025-10-29 11:49:13,019 - __main__ - INFO - 
✓ Final test summary saved to: test/mapping_test_output/run_20251029_114912/TEST_SUMMARY.txt
2025-10-29 11:49:13,019 - __main__ - INFO - 
================================================================================
2025-10-29 11:49:13,019 - __main__ - INFO - TEST SUITE COMPLETED SUCCESSFULLY
2025-10-29 11:49:13,019 - __main__ - INFO - ================================================================================
2025-10-29 11:49:13,019 - __main__ - INFO - 
All test outputs saved to: test/mapping_test_output/run_20251029_114912
2025-10-29 11:49:13,019 - __main__ - INFO - View complete log: test/mapping_test_output/run_20251029_114912/mapping_test.log
2025-10-29 11:49:13,019 - __main__ - INFO - ================================================================================
